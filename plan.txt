{
    id,
    login,
    hash
}

api/register { login, password }
    saveUserToDb({ login, generateHash( password ) })

    session = createSession( user )
    saveSessionInCache( session )
    token = createJwt( session ).sign()
    send token

api/login { login, password }
    findUserInDb( login )
    checkUserPassword( password )
    if ( error ) return error 400 access denied
    else
    
    session = createSession( user )
    saveSessionInCache( session )
    token = createJwt( session ).sign()
    send token

api/anypage { token }
    if ( token is expired ) return error unauthorized
    else if ( token.session_id not in sessions ) return error unauthorized
    else okay

api/logout { token }
    delete sessions[ token.session_id ]
